# üéØ MASTER RAPPORT - PENGEPLAN v1.2.0
## Komplett regnskaps- og √∏konomisystem for privatpersoner

---

## üìã **EXECUTIVE SUMMARY**

Pengeplan er et revolusjonerende √∏konomisystem designet spesielt for norske privatpersoner og √∏konomisk utsatte brukere. Systemet integrerer norsk regelverk, BankID-autentisering, NAV-st√∏tteordninger og AI-r√•dgivning i en brukervennlig plattform.

### üéØ **Hovedm√•l**
- **Lovmessig riktig** etter norsk regelverk (Lovdata.no, Skatteetaten.no, NAV)
- **Privat og sikker** (GDPR, kryptering, tilgangskontroll)
- **Brukervennlig** for privatpersoner uten √∏konomisk ekspertise
- **Full admin-kontroll** med overv√•king og funksjonsstyring

---

## üîç **RESEARCH & KRAVSPESIFIKASJON**

### **Markedsanalyse - Eksisterende l√∏sninger**

#### **Norske l√∏sninger:**
- **Tripletex**: Kompleks, rettet mot bedrifter
- **Fiken**: Enkel, men mangler NAV-integrasjon
- **Visma**: Enterprise-fokus, kostbar
- **Conta**: Middels kompleksitet, begrenset funksjonalitet

#### **Internasjonale l√∏sninger:**
- **Mint (Intuit)**: Ikke tilgjengelig i Norge
- **YNAB**: Kompleks, engelsk-spr√•klig
- **Quicken**: Desktop-basert, ikke web

#### **Gap-analyse:**
‚úÖ **Mangler**: Norsk-spr√•klig, NAV-integrasjon, BankID, GDPR-kompatibel
‚úÖ **Behov**: Enkel brukergrensesnitt, automatisk st√∏tteordning-s√∏k
‚úÖ **Mulighet**: F√∏rst til markedet med komplett norsk l√∏sning

### **Juridiske krav - Norsk regelverk**

#### **Bokf√∏ringsloven:**
- Privatpersoner ikke p√•lagt bokf√∏ring
- Frivillig system m√• f√∏lge regnskapsprinsipper
- Beviskrav for skattefradrag

#### **Personopplysningsloven (GDPR):**
- Samtykke for databehandling
- Retten til sletting og eksport
- Dataminimering og form√•lsbegrensning
- Sikker lagring og overf√∏ring

#### **Skatteloven:**
- Dokumentasjon av inntekter og utgifter
- Beviskrav for fradrag
- √Örlig skattemelding (RF-1030)

#### **NAV-st√∏tteordninger:**
- Automatisk s√∏k basert p√• brukerdata
- Integrasjon med Altinn for s√∏knader
- Sikker h√•ndtering av sensitive opplysninger

---

## üöÄ **FUNKSJONSLISTE - BRUKER**

### **MVP (Minimum Viable Product)**

#### **üìä Grunnleggende √∏konomioverblikk**
- **Inntekter**: L√∏nn, trygd, andre inntekter
- **Utgifter**: Fast, variabel, engangs
- **Budsjett**: M√•nedlig oversikt med varsler
- **Gjeld**: Oversikt over l√•n og renter
- **Nettoformue**: Beregning av total √∏konomisk status

#### **üîê Sikker innlogging**
- **E-post/passord**: Standard autentisering
- **BankID**: Sikker norsk eID-l√∏sning
- **To-faktor autentisering**: SMS eller app-basert

#### **üì± Responsivt design**
- **Mobile-first**: Optimalisert for iPhone/Android
- **Tablet-st√∏tte**: iPad og andre tablets
- **Desktop**: Full funksjonalitet p√• PC/Mac

### **PLUS (Utvidet funksjonalitet)**

#### **üè¶ Bank-integrasjon**
- **Open Banking API**: Sikker tilgang til bankdata
- **Automatisk import**: Transaksjoner og saldo
- **Kategorisering**: AI-drevet kategorisering av utgifter

#### **üìã NAV-st√∏tteordninger**
- **Automatisk s√∏k**: Basert p√• brukerdata
- **S√∏knadshjelp**: Steg-for-steg veiledning
- **Status-oppdateringer**: Integrasjon med NAV
- **Dokumentopplasting**: Kvitteringer og bevis

#### **ü§ñ AI-√∏konomir√•dgiver**
- **Personlig r√•dgivning**: Basert p√• √∏konomisk situasjon
- **Budsjettforslag**: Automatiske anbefalinger
- **Gjeldsh√•ndtering**: Snowball/avalanche-metoder
- **Skatteoptimalisering**: Fradrag og st√∏tteordninger

#### **üìÑ Dokumenth√•ndtering**
- **OCR-scanning**: Automatisk tekstgjenkjenning
- **Kvitteringsarkiv**: Sikker lagring av bevis
- **PDF-eksport**: Rapporter og dokumentasjon
- **Backup**: Automatisk sikkerhetskopi

### **PREMIUM (Avansert funksjonalitet)**

#### **üìä Avanserte rapporter**
- **√Örlig oversikt**: Komplett √∏konomisk rapport
- **Skattemelding**: Automatisk RF-1030
- **Gjeldanalyse**: Detaljert gjeldsoversikt
- **Investeringsanalyse**: Portef√∏lje og avkastning

#### **üîó API-integrasjoner**
- **Altinn**: Automatisk skattemelding
- **Banker**: Direkte tilgang til kontoer
- **NAV**: Status og s√∏knader
- **Skatteetaten**: Automatisk fradrag

---

## ‚öôÔ∏è **FUNKSJONSLISTE - ADMIN**

### **üë• Brukeradministrasjon**
- **Brukeroversikt**: Alle registrerte brukere
- **Rolleh√•ndtering**: Gratis, Premium, Admin
- **Statuskontroll**: Aktiv, inaktiv, suspendert
- **Brukerstatistikk**: Aktivitet og bruk

### **üîß Systemkontroll**
- **Modulstyring**: Sl√• av/p√• funksjoner
- **API-integrasjoner**: Konfigurere eksterne tjenester
- **Sikkerhetsinnstillinger**: RLS-policy og kryptering
- **Backup og gjenoppretting**: Automatisk og manuell

### **üìä Overv√•king og rapportering**
- **Systemlogg**: Alle brukerhandlinger
- **Feilrapportering**: Automatisk feilh√•ndtering
- **Ytelsesoverv√•king**: Server og database
- **Brukerstatistikk**: Aggregerte data (ikke persondata)

### **üîí Sikkerhet og compliance**
- **GDPR-overv√•king**: Samtykke og databehandling
- **Sikkerhetslogg**: Innbruddsfors√∏k og mistenkelig aktivitet
- **Backup-verifisering**: Test av gjenoppretting
- **Compliance-rapporter**: Lovmessig overholdelse

---

## üóÑÔ∏è **DATABASE & BACKEND (SUPABASE)**

### **üìã Tabellstruktur**

```sql
-- Brukere og profiler
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255),
    role VARCHAR(50) DEFAULT 'user',
    status VARCHAR(50) DEFAULT 'active',
    created_at TIMESTAMP DEFAULT NOW(),
    last_login TIMESTAMP,
    bankid_id VARCHAR(255),
    two_factor_enabled BOOLEAN DEFAULT FALSE
);

CREATE TABLE profiles (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    phone VARCHAR(20),
    birth_date DATE,
    address JSONB,
    employment_status VARCHAR(50),
    household_type VARCHAR(50),
    annual_income DECIMAL(12,2),
    preferences JSONB,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- √òkonomiske data
CREATE TABLE incomes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    type VARCHAR(50) NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    frequency VARCHAR(20) DEFAULT 'monthly',
    source VARCHAR(100),
    start_date DATE,
    end_date DATE,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE expenses (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    category VARCHAR(50) NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    description TEXT,
    date DATE NOT NULL,
    recurring BOOLEAN DEFAULT FALSE,
    receipt_url VARCHAR(500),
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE debts (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    name VARCHAR(100) NOT NULL,
    amount DECIMAL(12,2) NOT NULL,
    interest_rate DECIMAL(5,4),
    monthly_payment DECIMAL(10,2),
    institution VARCHAR(100),
    debt_type VARCHAR(50),
    start_date DATE,
    end_date DATE,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE budgets (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    category VARCHAR(50) NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    period VARCHAR(20) DEFAULT 'monthly',
    start_date DATE,
    end_date DATE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- NAV og st√∏tteordninger
CREATE TABLE support_programs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(200) NOT NULL,
    description TEXT,
    category VARCHAR(50),
    eligibility_criteria JSONB,
    application_url VARCHAR(500),
    max_amount DECIMAL(12,2),
    active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE user_support_applications (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    program_id UUID REFERENCES support_programs(id),
    status VARCHAR(50) DEFAULT 'pending',
    applied_date DATE,
    approved_date DATE,
    amount DECIMAL(12,2),
    notes TEXT,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Dokumenter og kvitteringer
CREATE TABLE documents (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    type VARCHAR(50) NOT NULL,
    filename VARCHAR(255) NOT NULL,
    file_url VARCHAR(500) NOT NULL,
    file_size INTEGER,
    mime_type VARCHAR(100),
    ocr_text TEXT,
    metadata JSONB,
    created_at TIMESTAMP DEFAULT NOW()
);

-- System og admin
CREATE TABLE system_settings (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    key VARCHAR(100) UNIQUE NOT NULL,
    value JSONB,
    description TEXT,
    updated_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE audit_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    action VARCHAR(100) NOT NULL,
    table_name VARCHAR(50),
    record_id UUID,
    old_values JSONB,
    new_values JSONB,
    ip_address INET,
    user_agent TEXT,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### **üîí Row Level Security (RLS)**

```sql
-- Aktiver RLS p√• alle tabeller
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE incomes ENABLE ROW LEVEL SECURITY;
ALTER TABLE expenses ENABLE ROW LEVEL SECURITY;
ALTER TABLE debts ENABLE ROW LEVEL SECURITY;
ALTER TABLE budgets ENABLE ROW LEVEL SECURITY;
ALTER TABLE user_support_applications ENABLE ROW LEVEL SECURITY;
ALTER TABLE documents ENABLE ROW LEVEL SECURITY;

-- Bruker kan kun se egne data
CREATE POLICY "Users can view own data" ON users
    FOR SELECT USING (auth.uid() = id);

CREATE POLICY "Users can view own profiles" ON profiles
    FOR ALL USING (auth.uid() = user_id);

CREATE POLICY "Users can view own incomes" ON incomes
    FOR ALL USING (auth.uid() = user_id);

CREATE POLICY "Users can view own expenses" ON expenses
    FOR ALL USING (auth.uid() = user_id);

CREATE POLICY "Users can view own debts" ON debts
    FOR ALL USING (auth.uid() = user_id);

CREATE POLICY "Users can view own budgets" ON budgets
    FOR ALL USING (auth.uid() = user_id);

CREATE POLICY "Users can view own applications" ON user_support_applications
    FOR ALL USING (auth.uid() = user_id);

CREATE POLICY "Users can view own documents" ON documents
    FOR ALL USING (auth.uid() = user_id);

-- Admin kan se alt
CREATE POLICY "Admins can view all data" ON users
    FOR ALL USING (
        EXISTS (
            SELECT 1 FROM users 
            WHERE id = auth.uid() AND role = 'admin'
        )
    );

-- St√∏tteordninger er offentlige
CREATE POLICY "Support programs are public" ON support_programs
    FOR SELECT USING (TRUE);
```

---

## üõ†Ô∏è **TEKNISK SPESIFIKASJON**

### **Frontend (HTML/CSS/JS)**
- **Vanilla JavaScript**: Ingen rammeverk for maksimal ytelse
- **ES6 Modules**: Modul√¶r arkitektur
- **Responsive Design**: Mobile-first tiln√¶rming
- **Accessibility**: WCAG 2.1 AA-kompatibel
- **PWA**: Progressive Web App funksjonalitet

### **Backend (Supabase)**
- **PostgreSQL**: Robust database
- **Real-time**: Live oppdateringer
- **Edge Functions**: Serverless API
- **Storage**: Sikker filopplasting
- **Auth**: Integrert autentisering

### **Hosting (Vercel)**
- **Edge Network**: Global CDN
- **Serverless**: Skalerbar arkitektur
- **Git Integration**: Automatisk deployment
- **Analytics**: Brukerstatistikk

### **Sikkerhet**
- **HTTPS**: Kryptert kommunikasjon
- **CSP**: Content Security Policy
- **CORS**: Cross-Origin Resource Sharing
- **Rate Limiting**: Beskyttelse mot angrep
- **Input Validation**: XSS og SQL injection beskyttelse

---

## üìÖ **FREMDIFTSPLAN**

### **MVP (M√•ned 1-2)**
- ‚úÖ Grunnleggende brukerregistrering og innlogging
- ‚úÖ Enkel √∏konomioverblikk (inntekter/utgifter)
- ‚úÖ Responsivt design for mobil/tablet
- ‚úÖ BankID-integrasjon
- üîÑ Grunnleggende NAV-st√∏tteordning-s√∏k

### **v1.0 (M√•ned 3-4)**
- üîÑ Komplett √∏konomioverblikk med budsjett
- üîÑ AI-√∏konomir√•dgiver (grunnleggende)
- üîÑ Dokumentopplasting og OCR
- üîÑ Rapporter og eksport
- üîÑ Admin-panel med brukeradministrasjon

### **v2.0 (M√•ned 5-6)**
- üîÑ Bank-integrasjon via Open Banking
- üîÑ Avanserte NAV-integrasjoner
- üîÑ Automatisk skattemelding
- üîÑ Avanserte rapporter og analyser
- üîÑ API for eksterne integrasjoner

### **v3.0 (M√•ned 7-8)**
- üîÑ Machine Learning for prediktiv analyse
- üîÑ Avanserte sikkerhetsfunksjoner
- üîÑ Multi-tenant arkitektur
- üîÑ Enterprise-funksjoner
- üîÑ Internasjonal ekspansjon

---

## ‚ö†Ô∏è **RISIKOVURDERING**

### **Tekniske risikoer**
- **Datasikkerhet**: GDPR-compliance og kryptering
- **Skalerbarhet**: H√•ndtering av √∏kende brukermengde
- **API-avhengighet**: Banker og offentlige tjenester
- **Ytelse**: Optimalisering for store datamengder

### **Juridiske risikoer**
- **GDPR**: Personvern og databehandling
- **Finansregulering**: PSD2 og Open Banking
- **Skatteetaten**: Automatisk skattemelding
- **NAV**: Sensitive personopplysninger

### **Forretningsrisikoer**
- **Markedskonkurranse**: Etablerte akt√∏rer
- **Brukeradopsjon**: Aksept av ny plattform
- **Teknisk kompetanse**: Utvikling og vedlikehold
- **Regulatoriske endringer**: Lovendringer

### **Mitigering**
- **Sikkerhetsaudit**: Regelmessig penetrasjonstesting
- **Juridisk r√•dgivning**: Kontinuerlig compliance
- **Brukerfeedback**: Iterativ utvikling
- **Backup-strategi**: Redundant infrastruktur

---

## üéØ **KONKLUSJON**

Pengeplan representerer en unik mulighet til √• revolusjonere √∏konomistyring for norske privatpersoner. Ved √• kombinere norsk regelverk, moderne teknologi og brukervennlig design, kan systemet bli den ledende l√∏sningen for √∏konomisk inkludering og selvstendighet.

### **N√∏kkelfaktorer for suksess:**
1. **Lovmessig compliance** fra dag √©n
2. **Brukervennlig design** for alle aldersgrupper
3. **Sikker og privat** databehandling
4. **Skalerbar arkitektur** for fremtidig vekst
5. **Kontinuerlig forbedring** basert p√• brukerfeedback

### **Neste steg:**
1. **Utvikling av MVP** med grunnleggende funksjonalitet
2. **Sikkerhetsaudit** og GDPR-compliance
3. **Bruker-testing** med m√•lgrupper
4. **Pilot-program** med NAV og andre partnere
5. **Markedsf√∏ring** og brukeradopsjon

---

*Rapport utarbeidet: 21. august 2025*  
*Versjon: 1.2.0*  
*Status: Klar for implementering*
